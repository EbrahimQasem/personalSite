$(document).ready(function(){function o(){$(".sponsor-container").length&&$(".sponsor-container").height($("#results-grid").height())}function e(){$(document).height()-s.height()<=s.scrollTop()+300?(n(!0),d=setTimeout(function(){e()},100)):clearTimeout(d)}function t(){g||(g=!0,$.ajax({type:"POST",url:window.loadMoreReferralUrl,data:{slice:m,slug:window.currentSearchQuery},success:function(o){if(g=!1,m++,o.length>0)for(i in o){var e='<div class="sponsor-grid-item" style="background-image: url('+o[i].previewUrl+"); height: "+Math.floor(o[i].height)+'px;"><a class="open-sponsor-image" href="'+o[i].link+'" target="_blank" rel="nofollow"></a></div>';$("#sponsor-end-of-list").before(e)}}}))}function a(o){$.ajax({type:"POST",url:window.loadMoreReferralUrl,data:{slice:1,limit:100,slug:window.currentSearchQuery?window.currentSearchQuery:"landscape"},success:function(e){var t="",i=[],a=e.length;if(a>0)if(a<=5)for(var n in e)i.push(e[n]);else for(;i.length<5;){var r=Math.floor(Math.random()*e.length);i.push(e[r]),e.splice(r,1)}if(i.length>0){$("#"+o+" .collage-of-images").show();for(var l in i)t+='<div class="img-display"><a class="open-image" href="'+i[l].link+'" target="_blank" rel="nofollow"><img src="'+i[l].previewUrl+'" alt=""/></a></div>'}else $("#"+o+" .collage-of-images").hide();$("#"+o+" .img-collage").html(t)}})}function n(e){return $(document).height()>s.height()&&!e?void clearTimeout(l):void(h||u||(h=!0,$("#loading").show(),$("#no-images").hide(),$.ajax({type:"POST",url:window.loadMoreUrl,data:{slice:c,slug:window.currentSearchQuery},success:function(e){if($("#loading").hide(),h=!1,c++,e.length>0)for(i in e){var t='<div class="grid-item"><a class="open-image" href="#" data-id="" data-author="" data-download=""></a>';void 0!=window.hideOverlay&&window.hideOverlay||(t+='<div class="overlay">',t+="</div>"),t+="</div>";var a=$(t),n=a.find("a.open-image"),l=a.find(".overlay a");void 0!==e[i].thumbUrl?a.css("background-image","url("+e[i].thumbUrl+")"):a.css("background-image","url("+e[i].previewUrl+")"),e[i].width>0&&e[i].height>0&&a.css("height",Math.floor(window.itemWidth*e[i].height/e[i].width)+"px"),void 0!=window.hideOverlay&&window.hideOverlay?(n.attr("href",e[i].link),n.attr("rel","nofollow")):n.attr("href","#"+e[i].id),n.attr("data-id",e[i].id),n.attr("data-author","local"!=e[i].provider?e[i].user+" @ "+e[i].provider:e[i].user),n.attr("data-download",e[i].imageUrl),e[i].link&&n.attr("data-link",e[i].link),l.attr("target","_blank"),l.attr("href",e[i].imageUrl),r.masonry().append(a).masonry("appended",a);var d=$(".lightbox:last").clone();d.length&&(d.attr("id",e[i].id),$(".lightbox-image",d).attr("data-image",e[i].previewUrl),$(".lightbox").last().after(d[0].outerHTML))}else u=!0,$("#no-images").show();o()}})))}window.location.href.split("#")[0]!=window.location.href&&(window.location.href=window.location.href.split("#")[0]),$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var r=$(".grid").masonry({itemSelector:".grid-item",columnWidth:".grid-sizer",gutter:".gutter-sizer",percentPosition:!0,originLeft:!0});r.imagesLoaded().progress(function(){r.masonry("layout")}),$(".ham-menu").on("click",function(){$(".collapsed-menu").toggleClass("collapsed-menu-open")}),$(".trigger").on("click",function(){return $(".modal-wrapper").toggleClass("open"),$(".homepage").toggleClass("overflow-body"),!1}),$(document).on("click",".open-image",function(){var o=$(this).data("id");$(this).data("link")&&""!=$(this).data("link")?$(".lightbox-bottom .image-author").html("<a href='"+$(this).data("link")+"' target='_blank' rel='nofollow'>by "+$(this).data("author")+"</a>"):$(".lightbox-bottom .image-author").html("by "+$(this).data("author")),$(".lightbox-bottom .download-btn").attr("href",$(this).data("download"));var e=$("#"+o+" .lightbox-image").data("image");if($(".lightbox-bottom img").length)$(".lightbox-bottom img").attr("src",e);else{var t=$('<img src="'+e+'" alt=""/>');$("#"+o+" .lightbox-image>img").each(function(o,e){e.remove()}),$("#"+o+" .lightbox-image").prepend(t)}a(o)}),$(document).on("touchstart",".lightbox",function(o){documentClick=!0}),$(document).on("touchmove",".lightbox",function(o){documentClick=!1}),$(document).on("click touchend",".lightbox",function(o){"click"==o.type&&(documentClick=!0),documentClick&&(window.location.href="#!")}),$(document).on("click touchstart",".download-btn, .image-author",function(o){o.stopPropagation()}),$(document).on("click",".download-btn",function(){if(Cookie.Read("downloadedLinks"))var o=Cookie.Read("downloadedLinks");else var o=0;return o<2&&!Cookie.Read("sharedLink")&&($(".thanks-modal-wrapper").addClass("open"),Cookie.Create("downloadedLinks",parseInt(o)+1,365)),!0}),$(document).on("click",".social-buttons a",function(){return Cookie.Create("sharedLink",!0,365),!0}),$(".close-modal-btn").on("click",function(){return $(".thanks-modal-wrapper").removeClass("open"),!1}),$(document).on("click",".discount-section",function(o){return o.preventDefault(),!1}),$(document).on("click",".img-collage img",function(o){o.stopPropagation()}),o();var l,d,c=2,s=$(window),h=!1,u=!1,g=!1,m=2;window.loadMoreUrl&&(s.scroll(function(){$(document).height()-s.height()<=s.scrollTop()+300&&n(!0),$("#sponsor-end-of-list").length&&$("#sponsor-end-of-list").offset().top-$(document).height()<=500&&t()}),l=setTimeout(function(){n(!1)},500)),e()});var Cookie={Create:function(o,e,t){var i="";if(t){var a=new Date;a.setTime(a.getTime()+24*t*60*60*1e3),i="; expires="+a.toGMTString()}document.cookie=o+"="+e+i+"; path=/"},Read:function(o){for(var e=o+"=",t=document.cookie.split(";"),i=0;i<t.length;i++){for(var a=t[i];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return null},Erase:function(o){Cookie.create(o,"",-1)}};